#See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.

FROM mcr.microsoft.com/dotnet/aspnet:6.0 AS base
RUN sed -i 's/MinProtocol = TLSv1.2/MinProtocol = TLSv1.0/g' /etc/ssl/openssl.cnf
RUN sed -i 's/MinProtocol = TLSv1.2/MinProtocol = TLSv1.0/g' /usr/lib/ssl/openssl.cnf
WORKDIR /app
EXPOSE 80
EXPOSE 443

FROM mcr.microsoft.com/dotnet/sdk:6.0 AS build
WORKDIR /src
COPY ["nuget.config", "."]
COPY ["Sinyi.SuperAgent.WebApp/Sinyi.SuperAgent.WebApp.csproj", "Sinyi.SuperAgent.WebApp/"]
COPY ["Sinyi.SuperAgent.Notifications.Services/Sinyi.SuperAgent.Notifications.Services.csproj", "Sinyi.SuperAgent.Notifications.Services/"]
COPY ["Sinyi.Notifications.PushMessage/Sinyi.Notifications.PushMessage.csproj", "Sinyi.Notifications.PushMessage/"]
COPY ["Sinyi.Net.Http/Sinyi.Net.Http.csproj", "Sinyi.Net.Http/"]
COPY ["Sinyi.SuperAgent.Tasks.Services/Sinyi.SuperAgent.Tasks.Services.csproj", "Sinyi.SuperAgent.Tasks.Services/"]
COPY ["Sinyi.Medals/Sinyi.Medals.csproj", "Sinyi.Medals/"]
COPY ["Sinyi.Tasks.Services/Sinyi.Tasks.Services.csproj", "Sinyi.Tasks.Services/"]
COPY ["Sinyi.Tasks.Accesses/Sinyi.Tasks.Accesses.csproj", "Sinyi.Tasks.Accesses/"]
COPY ["Sinyi.Realties/Sinyi.Realties.csproj", "Sinyi.Realties/"]
COPY ["Sinyi.Geographies/Sinyi.Geographies.csproj", "Sinyi.Geographies/"]
COPY ["Sinyi.Helpers/Sinyi.Helpers.csproj", "Sinyi.Helpers/"]
COPY ["Sinyi.Stores/Sinyi.Stores.csproj", "Sinyi.Stores/"]
COPY ["Sinyi.Tasks/Sinyi.Tasks.csproj", "Sinyi.Tasks/"]
COPY ["Sinyi.Tasks.Hosting/Sinyi.Tasks.Hosting.csproj", "Sinyi.Tasks.Hosting/"]
COPY ["Sinyi.SuperAgent.Medals/Sinyi.SuperAgent.Medals.csproj", "Sinyi.SuperAgent.Medals/"]
COPY ["Sinyi.SuperAgent.CommunityCabinets.Services/Sinyi.SuperAgent.CommunityCabinets.Services.csproj", "Sinyi.SuperAgent.CommunityCabinets.Services/"]
COPY ["Sinyi.Agents/Sinyi.Agents.csproj", "Sinyi.Agents/"]
COPY ["Sinyi.Messages/Sinyi.Messages.csproj", "Sinyi.Messages/"]
COPY ["Sinyi.Identity.Agents/Sinyi.Identity.Agents.csproj", "Sinyi.Identity.Agents/"]
COPY ["Sinyi.SuperAgent.CommunityCabinets/Sinyi.SuperAgent.CommunityCabinets.csproj", "Sinyi.SuperAgent.CommunityCabinets/"]
COPY ["Sinyi.ActualPrices/Sinyi.ActualPrices.csproj", "Sinyi.ActualPrices/"]
COPY ["Sinyi.Trading/Sinyi.Trading.csproj", "Sinyi.Trading/"]
COPY ["Sinyi.SuperAgent.Taxes.Services/Sinyi.SuperAgent.Taxes.Services.csproj", "Sinyi.SuperAgent.Taxes.Services/"]
COPY ["Sinyi.Taxes/Sinyi.Taxes.csproj", "Sinyi.Taxes/"]
COPY ["Sinyi.SuperAgent.Realties.Services/Sinyi.SuperAgent.Realties.Services.csproj", "Sinyi.SuperAgent.Realties.Services/"]
COPY ["Sinyi.SuperAgent.Agents/Sinyi.SuperAgent.Agents.csproj", "Sinyi.SuperAgent.Agents/"]
COPY ["Sinyi.SuperAgent.Realties/Sinyi.SuperAgent.Realties.csproj", "Sinyi.SuperAgent.Realties/"]
COPY ["Sinyi.Customer/Sinyi.Customers.csproj", "Sinyi.Customer/"]
COPY ["Sinyi.SuperAgent.Realties.Hosting/Sinyi.SuperAgent.Realties.Hosting.csproj", "Sinyi.SuperAgent.Realties.Hosting/"]
COPY ["Sinyi.SuperAgent.Realties.Accesses/Sinyi.SuperAgent.Realties.Accesses.csproj", "Sinyi.SuperAgent.Realties.Accesses/"]
COPY ["Sinyi.SuperAgent.BusinessCards.Hosting/Sinyi.SuperAgent.BusinessCards.Hosting.csproj", "Sinyi.SuperAgent.BusinessCards.Hosting/"]
COPY ["Sinyi.SuperAgent.BusinessCards/Sinyi.SuperAgent.BusinessCards.csproj", "Sinyi.SuperAgent.BusinessCards/"]
COPY ["Sinyi.BusinessCards/Sinyi.BusinessCards.csproj", "Sinyi.BusinessCards/"]
COPY ["Sinyi.SuperAgent.BusinessCards.Accesses/Sinyi.SuperAgent.BusinessCards.Accesses.csproj", "Sinyi.SuperAgent.BusinessCards.Accesses/"]
COPY ["Sinyi.SuperAgent.Customers.Services/Sinyi.SuperAgent.Customers.Services.csproj", "Sinyi.SuperAgent.Customers.Services/"]
COPY ["Sinyi.SuperAgent.Customers/Sinyi.SuperAgent.Customers.csproj", "Sinyi.SuperAgent.Customers/"]
COPY ["Sinyi.Customer.Services/Sinyi.Customers.Services.csproj", "Sinyi.Customer.Services/"]
COPY ["Sinyi.SuperAgent.Commons.Services/Sinyi.SuperAgent.Commons.Services.csproj", "Sinyi.SuperAgent.Commons.Services/"]
COPY ["Sinyi.WebApp/Sinyi.WebApp.csproj", "Sinyi.WebApp/"]
COPY ["Sinyi.Identity.Agents.Services/Sinyi.Identity.Agents.Services.csproj", "Sinyi.Identity.Agents.Services/"]
COPY ["Sinyi.BusinessCards.Services/Sinyi.BusinessCards.Services.csproj", "Sinyi.BusinessCards.Services/"]
COPY ["Sinyi.Net.Email/Sinyi.Net.Email.csproj", "Sinyi.Net.Email/"]
COPY ["Sinyi.ActualPrice.Services/Sinyi.ActualPrices.Services.csproj", "Sinyi.ActualPrice.Services/"]
COPY ["Sinyi.Trading.Hosting/Sinyi.Trading.Hosting.csproj", "Sinyi.Trading.Hosting/"]
COPY ["Sinyi.Trading.Providers/Sinyi.Trading.Providers.csproj", "Sinyi.Trading.Providers/"]
COPY ["Sinyi.Trading.Accesses/Sinyi.Trading.Accesses.csproj", "Sinyi.Trading.Accesses/"]
COPY ["Sinyi.Realties.Hosting/Sinyi.Realties.Hosting.csproj", "Sinyi.Realties.Hosting/"]
COPY ["Sinyi.ActualPrice.Hosting/Sinyi.ActualPrices.Hosting.csproj", "Sinyi.ActualPrice.Hosting/"]
COPY ["Sinyi.ActualPrice.Accesses/Sinyi.ActualPrices.Accesses.csproj", "Sinyi.ActualPrice.Accesses/"]
COPY ["Sinyi.Realties.Accesses/Sinyi.Realties.Accesses.csproj", "Sinyi.Realties.Accesses/"]
COPY ["Sinyi.Stores.Hosting/Sinyi.Stores.Hosting.csproj", "Sinyi.Stores.Hosting/"]
COPY ["Sinyi.Stores.Accesses/Sinyi.Stores.Accesses.csproj", "Sinyi.Stores.Accesses/"]
COPY ["Sinyi.Geographies.Services/Sinyi.Geographies.Services.csproj", "Sinyi.Geographies.Services/"]
COPY ["Sinyi.Messages.Services/Sinyi.Messages.Services.csproj", "Sinyi.Messages.Services/"]
COPY ["Sinyi.Messages.Accesses/Sinyi.Messages.Accesses.csproj", "Sinyi.Messages.Accesses/"]
COPY ["Sinyi.Messages.Hosting/Sinyi.Messages.Hosting.csproj", "Sinyi.Messages.Hosting/"]
COPY ["Sinyi.Scheduler.Hosting/Sinyi.Schedulers.Hosting.csproj", "Sinyi.Scheduler.Hosting/"]
COPY ["Sinyi.Scheduler.Accesses/Sinyi.Schedulers.Accesses.csproj", "Sinyi.Scheduler.Accesses/"]
COPY ["Sinyi.Scheduler/Sinyi.Schedulers.csproj", "Sinyi.Scheduler/"]
COPY ["Sinyi.Caching.Hosting/Sinyi.Caching.Hosting.csproj", "Sinyi.Caching.Hosting/"]
COPY ["Sinyi.Caching/Sinyi.Caching.csproj", "Sinyi.Caching/"]
COPY ["Sinyi.Versions.Hosting/Sinyi.Versions.Hosting.csproj", "Sinyi.Versions.Hosting/"]
COPY ["Sinyi.Versions.Accesses/Sinyi.Versions.Accesses.csproj", "Sinyi.Versions.Accesses/"]
COPY ["Sinyi.Versions/Sinyi.Versions.csproj", "Sinyi.Versions/"]
COPY ["Sinyi.Geographies.Hosting/Sinyi.Geographies.Hosting.csproj", "Sinyi.Geographies.Hosting/"]
COPY ["Sinyi.Geographies.Accesses/Sinyi.Geographies.Accesses.csproj", "Sinyi.Geographies.Accesses/"]
COPY ["Sinyi.BusinessCards.Hosting/Sinyi.BusinessCards.Hosting.csproj", "Sinyi.BusinessCards.Hosting/"]
COPY ["Sinyi.BusinessCards.Accesses/Sinyi.BusinessCards.Accesses.csproj", "Sinyi.BusinessCards.Accesses/"]
COPY ["Sinyi.Realties.Services/Sinyi.Realties.Services.csproj", "Sinyi.Realties.Services/"]
COPY ["Sinyi.Identity.Agents.Hosting/Sinyi.Identity.Agents.Hosting.csproj", "Sinyi.Identity.Agents.Hosting/"]
COPY ["Sinyi.Identity.Agents.Accesses/Sinyi.Identity.Agents.Accesses.csproj", "Sinyi.Identity.Agents.Accesses/"]
COPY ["Sinyi.Agents.Services/Sinyi.Agents.Services.csproj", "Sinyi.Agents.Services/"]
COPY ["Sinyi.Agents.Hosting/Sinyi.Agents.Hosting.csproj", "Sinyi.Agents.Hosting/"]
COPY ["Sinyi.Agents.Accesses/Sinyi.Agents.Accesses.csproj", "Sinyi.Agents.Accesses/"]
COPY ["Sinyi.Scheduler.Services/Sinyi.Schedulers.Services.csproj", "Sinyi.Scheduler.Services/"]
COPY ["Sinyi.Net.Http.Hosting/Sinyi.Net.Http.Hosting.csproj", "Sinyi.Net.Http.Hosting/"]
COPY ["Sinyi.Net.Email.Hosting/Sinyi.Net.Email.Hosting.csproj", "Sinyi.Net.Email.Hosting/"]
COPY ["Sinyi.Trading.Services/Sinyi.Trading.Services.csproj", "Sinyi.Trading.Services/"]
COPY ["Sinyi.Notifications.PushMessage.Hosting/Sinyi.Notifications.PushMessage.Hosting.csproj", "Sinyi.Notifications.PushMessage.Hosting/"]
COPY ["Sinyi.Taxes.Hosting/Sinyi.Taxes.Hosting.csproj", "Sinyi.Taxes.Hosting/"]
COPY ["Sinyi.Taxes.Accesses/Sinyi.Taxes.Accesses.csproj", "Sinyi.Taxes.Accesses/"]
COPY ["Sinyi.Stores.Services/Sinyi.Stores.Services.csproj", "Sinyi.Stores.Services/"]
COPY ["Sinyi.Medals.Hosting/Sinyi.Medals.Hosting.csproj", "Sinyi.Medals.Hosting/"]
COPY ["Sinyi.Medals.Accesses/Sinyi.Medals.Accesses.csproj", "Sinyi.Medals.Accesses/"]
COPY ["Sinyi.Customer.Hosting/Sinyi.Customers.Hosting.csproj", "Sinyi.Customer.Hosting/"]
COPY ["Sinyi.Customer.Accesses/Sinyi.Customers.Accesses.csproj", "Sinyi.Customer.Accesses/"]
COPY ["Sinyi.Customers.Providers/Sinyi.Customers.Providers.csproj", "Sinyi.Customers.Providers/"]
COPY ["Sinyi.SuperAgent.ActualPrices.Services/Sinyi.SuperAgent.ActualPrices.Services.csproj", "Sinyi.SuperAgent.ActualPrices.Services/"]
COPY ["Sinyi.SuperAgent.ActualPrices/Sinyi.SuperAgent.ActualPrices.csproj", "Sinyi.SuperAgent.ActualPrices/"]
COPY ["Sinyi.SuperAgent.Medals.Hosting/Sinyi.SuperAgent.Medals.Hosting.csproj", "Sinyi.SuperAgent.Medals.Hosting/"]
COPY ["Sinyi.SuperAgent.Medals.Accesses/Sinyi.SuperAgent.Medals.Accesses.csproj", "Sinyi.SuperAgent.Medals.Accesses/"]
COPY ["Sinyi.SuperAgent.Trading.Services/Sinyi.SuperAgent.Trading.Services.csproj", "Sinyi.SuperAgent.Trading.Services/"]
COPY ["Sinyi.SuperAgent.ActualPrices.Hosting/Sinyi.SuperAgent.ActualPrices.Hosting.csproj", "Sinyi.SuperAgent.ActualPrices.Hosting/"]
COPY ["Sinyi.SuperAgent.ActualPrices.Accesses/Sinyi.SuperAgent.ActualPrices.Accesses.csproj", "Sinyi.SuperAgent.ActualPrices.Accesses/"]
COPY ["Sinyi.SuperAgent.Medals.Services/Sinyi.SuperAgent.Medals.Services.csproj", "Sinyi.SuperAgent.Medals.Services/"]
COPY ["Sinyi.SuperAgent.Messages.Services/Sinyi.SuperAgent.Messages.Services.csproj", "Sinyi.SuperAgent.Messages.Services/"]
COPY ["Sinyi.SuperAgent.Messages/Sinyi.SuperAgent.Messages.csproj", "Sinyi.SuperAgent.Messages/"]
COPY ["Sinyi.SuperAgent.CommunityCabinets.Hosting/Sinyi.SuperAgent.CommunityCabinets.Hosting.csproj", "Sinyi.SuperAgent.CommunityCabinets.Hosting/"]
COPY ["Sinyi.SuperAgent.CommunityCabinets.Accesses/Sinyi.SuperAgent.CommunityCabinets.Accesses.csproj", "Sinyi.SuperAgent.CommunityCabinets.Accesses/"]
COPY ["Sinyi.SuperAgent.Tests.Services/Sinyi.SuperAgent.Tests.Services.csproj", "Sinyi.SuperAgent.Tests.Services/"]
COPY ["Sinyi.SuperAgent.Agents.Hosting/Sinyi.SuperAgent.Agents.Hosting.csproj", "Sinyi.SuperAgent.Agents.Hosting/"]
COPY ["Sinyi.SuperAgent.Agents.Services/Sinyi.SuperAgent.Agents.Services.csproj", "Sinyi.SuperAgent.Agents.Services/"]
COPY ["Sinyi.SuperAgent.WebPlatform/Sinyi.SuperAgent.WebPlatform.csproj", "Sinyi.SuperAgent.WebPlatform/"]
COPY ["Sinyi.SuperAgent.Versions.Services/Sinyi.SuperAgent.Versions.Services.csproj", "Sinyi.SuperAgent.Versions.Services/"]
COPY ["Sinyi.SuperAgent.BusinessCards.Services/Sinyi.SuperAgent.BusinessCards.Services.csproj", "Sinyi.SuperAgent.BusinessCards.Services/"]
RUN dotnet restore "Sinyi.SuperAgent.WebApp/Sinyi.SuperAgent.WebApp.csproj"
COPY . .
WORKDIR "/src/Sinyi.SuperAgent.WebApp"
RUN dotnet build "Sinyi.SuperAgent.WebApp.csproj" -c Release -o /app/build

FROM build AS publish
RUN dotnet publish "Sinyi.SuperAgent.WebApp.csproj" -c Release -o /app/publish

FROM base AS final
WORKDIR /app
COPY --from=publish /app/publish .
ENTRYPOINT ["dotnet", "Sinyi.SuperAgent.WebApp.dll"]